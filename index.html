<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Initialize Firebase Data</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <h1>Admin: Initialize Firebase Data</h1>
    <button onclick="initializeSettings()">Set Default Passcode</button>
    <button onclick="initializeUsers()">Add Default Users</button>
    <button onclick="initializeGoals()">Add Default Goals</button>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCXH3CI4YN4fRDH1Wcp_PQQCGBvpp8Dep8",
            authDomain: "goal-storing.firebaseapp.com",
            projectId: "goal-storing",
            storageBucket: "goal-storing.appspot.com",
            messagingSenderId: "1041018123354",
            appId: "1:1041018123354:web:497f0baf04deb124ccd463",
            measurementId: "G-1FPM1DV7KH"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Initialize default passcode in the settings collection
        async function initializeSettings() {
            try {
                await db.collection("settings").doc("config").set({ passcode: "sharedcode" });
                alert("Default passcode set successfully.");
            } catch (error) {
                console.error("Error setting passcode:", error);
                alert("Failed to set default passcode.");
            }
        }

        // Initialize default users in the users collection
        async function initializeUsers() {
            const defaultUsers = [
                { username: "admin" },
                { username: "user1" },
                { username: "user2" }
            ];

            try {
                const batch = db.batch();
                defaultUsers.forEach(user => {
                    const userRef = db.collection("users").doc(); // Generate new document ID
                    batch.set(userRef, user);
                });
                await batch.commit();
                alert("Default users added successfully.");
            } catch (error) {
                console.error("Error adding users:", error);
                alert("Failed to add default users.");
            }
        }

        // Initialize default goals in the goals collection
        async function initializeGoals() {
            const defaultGoals = [
                { description: "Workout 3 times a week" },
                { description: "No sugary snacks" },
                { description: "Read a book each month" }
            ];

            try {
                const batch = db.batch();
                defaultGoals.forEach(goal => {
                    const goalRef = db.collection("goals").doc(); // Generate new document ID
                    batch.set(goalRef, goal);
                });
                await batch.commit();
                alert("Default goals added successfully.");
            } catch (error) {
                console.error("Error adding goals:", error);
                alert("Failed to add default goals.");
            }
        }
    </script>
</body>
</html>
